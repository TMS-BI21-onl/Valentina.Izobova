1.
SELECT manager_id, COUNT(Employee_ID) AS cnt_employees
FROM Employees
GROUP BY manager_id
HAVING COUNT(Employee_ID) > 6);


2. 
SELECT D.DEPARTMENT_NAME,
       MIN(E.SALARY * (1 - E.COMMISSION_PCT / 100)) AS Min,
       MAX(E.SALARY * (1 - E.COMMISSION_PCT / 100)) AS Max
FROM Employees E
JOIN Departmrnts D ON E.Department_ID = D.Depapartment_ID
GROUP BY D.DEPARTMENT_NAME;


3.  
Select TOP 1 with TIES T.REGIONS_NAME
FROM (SELECT R.REGIONS_NAME,  COUNT (E.Emploe_ID) AS cnt
  FROM EMPLOYES E
  JOIN DEPARTMENTS D ON D.DEPARTMENT_ID = E.DEPARTMENT_ID
  JOIN LOCATIONS L ON L.LOCATION_ID = D.LOCATION_ID
  JOIN COUNTRIES C ON C.COUNTRY_ID = L.COUNTRY_ID
  JOIN REGIONS R ON R.REGION_ID = C.REGION_ID
  GROUP BY R.REGIONS_NAME
  ORDER BY cnt DESC ) T


4.  
 SELECT D.DEPARTMENT_NAME, 
       AVG(E.SALARY) AS department_avg_salary,
       (AVG (E.SALARY) / (SELECT AVG (E.SALARY) FROM EMPLOYEES E) - 1)*100 AS DIFF
  FROM EMPLOYEE E
  JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
  GROUP BY D.DEPARTMENT_NAME;


5.   
SELECT E.First_Name, E.Last_Name, department_id, DATEDIFF (year ,J.START_DATE, ISNULL(end_date,GETDATE())) as exp
  FROM EMPLOYEES JOB_HISTORY E
  JOIN JOB_HISTORY J  ON E.EMPLOYEE_ID = J.EMPLOYEE_ID
  WHERE DATEDIFF (year ,J.START_DATE, ISNULL(end_date,GETDATE())) >10


6.   
SELECT FIRST_NAME, LAST_NAME
FROM
  (SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, SALARY, ROW_NUMBER() OVER (ORDER BY salary DESC) AS PN
  FROM EMPLOYEES
  WHERE PN BETWEEN 5 AND 10;